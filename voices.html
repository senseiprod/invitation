<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElevenLabs Voice Library</title>
    <style>
        /* Basic Styling */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 20px;
        }

        h1 {
            color: #1a253c;
        }

        /* Filter Controls */
        .filter-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .filter-container label {
            font-size: 1.1em;
            font-weight: 500;
        }

        #language-filter {
            padding: 10px 15px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #fff;
            cursor: pointer;
            min-width: 200px;
        }

        /* Voice List Grid */
        #voice-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        /* Voice Card Styling */
        .voice-card {
            background-color: #ffffff;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .voice-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .voice-card h3 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.2em;
            color: #0056b3;
        }
        
        .voice-card audio {
            width: 100%;
            border-radius: 4px;
        }

        /* Status Message */
        #status-message {
            text-align: center;
            font-size: 1.2em;
            color: #777;
            padding: 40px 0;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Voice Library</h1>
            <div class="filter-container">
                <label for="language-filter">Filter by Language:</label>
                <select id="language-filter">
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>
        </header>

        <div id="status-message">Loading voices...</div>
        <div id="voice-list">
            <!-- Voice cards will be populated by JavaScript -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const voiceListContainer = document.getElementById('voice-list');
            const languageFilter = document.getElementById('language-filter');
            const statusMessage = document.getElementById('status-message');

            let allVoices = []; // This will hold all voice data from the JSON file

            // Language data you provided
            const LANGUAGES = [
                { code: "all", name: "All Languages" },
                { code: "en", name: "Anglais", active: true },
                { code: "fr", name: "Français" },
                { code: "de", name: "Allemand" },
                { code: "es", name: "Espagnol" },
                { code: "ar", name: "Arabe" },
                { code: "pt", name: "Portugais" },
                { code: "tr", name: "Turc" },
                { code: "it", name: "Italien" },
                { code: "hi", name: "Hindi" },
                { code: "ru", name: "Russe" },
                { code: "ja", name: "Japonais" },
                { code: "ko", name: "Coréen" },
                { code: "zh", name: "Chinois" },
                { code: "vi", name: "Vietnamien" },
                { code: "pl", name: "Polonais" },
                { code: "ro", name: "Roumain" },
                { code: "nl", name: "Néerlandais" },
                { code: "sv", name: "Suédois" },
                { code: "fi", name: "Finnois" },
                { code: "no", name: "Norvégien" },
                { code: "da", name: "Danois" },
                { code: "hu", name: "Hongrois" },
                { code: "cs", name: "Tchèque" },
                { code: "el", name: "Grec" },
                { code: "th", name: "Thaï" },
                { code: "id", name: "Indonésien" },
                { code: "ms", name: "Malais" }
                // Add any other languages from your list here
            ];

            // 1. Populate the language filter dropdown
            function populateFilter() {
                LANGUAGES.forEach(lang => {
                    const option = document.createElement('option');
                    option.value = lang.code;
                    option.textContent = lang.name;
                    if (lang.active) {
                        option.selected = true;
                    }
                    languageFilter.appendChild(option);
                });
            }

            // 2. Function to render a list of voices to the page
            function renderVoices(voicesToRender) {
                voiceListContainer.innerHTML = ''; // Clear previous results

                if (voicesToRender.length === 0) {
                    statusMessage.textContent = 'No voices found for this language.';
                    statusMessage.style.display = 'block';
                    return;
                }
                
                statusMessage.style.display = 'none';

                voicesToRender.forEach(voice => {
                    const card = document.createElement('div');
                    card.className = 'voice-card';
                    card.innerHTML = `
                        <h3>${voice.name}</h3>
                        <audio controls src="${voice.preview_url}">
                            Your browser does not support the audio element.
                        </audio>
                    `;
                    voiceListContainer.appendChild(card);
                });
            }

            // 3. Filter the voices based on the selected language and render them
            function filterAndRender() {
                const selectedLanguage = languageFilter.value;

                if (selectedLanguage === 'all') {
                    renderVoices(allVoices);
                } else {
                    const filteredVoices = allVoices.filter(voice => voice.language === selectedLanguage);
                    renderVoices(filteredVoices);
                }
            }

            // 4. Main function to fetch data and initialize the page
            async function initialize() {
                try {
                    // Fetch the JSON data from the local file
                    const response = await fetch('all_shared_voices_updated.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    allVoices = data.voices; // Store the voices in our global variable

                    populateFilter(); // Set up the dropdown
                    filterAndRender(); // Perform the initial render based on the default filter

                    // Add an event listener to re-filter when the selection changes
                    languageFilter.addEventListener('change', filterAndRender);

                } catch (error) {
                    console.error("Failed to load or process voice data:", error);
                    statusMessage.textContent = 'Error: Could not load voice data. Make sure the JSON file is present and you are using a local server.';
                    statusMessage.style.color = 'red';
                }
            }
            
            // Start the application
            initialize();
        });
    </script>

</body>
</html>